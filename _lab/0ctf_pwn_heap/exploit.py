from pwn import *
 
def alloc(size):
    conn.sendlineafter("Command: ", "1")
    conn.sendlineafter("Size: ", str(size))
 
def fill(index, size, content):
    conn.sendlineafter("Command: ", "2")
    conn.sendlineafter("Index: ", str(index))
    conn.sendlineafter("Size: ", str(size))
    conn.sendafter("Content:", content)
 
def dump(index):
    conn.sendlineafter("Command: ", "4")
    conn.sendlineafter("Index: ", str(index))
 
def free(index):
    conn.sendlineafter("Command: ", "3")
    conn.sendlineafter("Index: ", str(index))
 
def exploit():
    alloc(0x20)
    pause()
    conn.interactive()
 
if __name__ == "__main__":
    conn = process("./babyheap_69a42acd160ab67a68047ca3f9c390b9")
    exploit()

